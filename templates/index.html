<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <title>QR-Code Scanner</title>
  <script src="https://unpkg.com/@zxing/library@0.18.6/umd/index.min.js"></script>
  <style>
    video {
      width: 100%;
      max-width: 400px;
    }
  </style>
</head>
<body>
  <h1>QR-Code Scanner</h1>
  <video id="video" autoplay></video>
  <div id="result">Starte Scanner...</div>

  <script>
    const codeReader = new ZXing.BrowserMultiFormatReader();
    const resultBox = document.getElementById('result');

    async function startScanner() {
      try {
        const devices = await navigator.mediaDevices.enumerateDevices();
        console.log(devices);
        const videoDevices = devices.filter(device => device.kind === 'videoinput');
        const selectedDeviceId = videoDevices[0]?.deviceId; // Use the first video input device

        if (selectedDeviceId) {
          codeReader.decodeFromVideoDevice(selectedDeviceId, 'video', (result, err) => {
            if (result) {
              resultBox.innerText = 'Erkannter QR-Code: ' + result.getText();
              codeReader.reset(); // Stop the scanner
            } else if (err && !(err instanceof ZXing.NotFoundException)) {
              console.error(err);
            }
          });
        } else {
          resultBox.innerText = 'Keine Kamera gefunden.';
        }
      } catch (err) {
        console.error(err);
        resultBox.innerText = 'Fehler beim Starten des Scanners.';
      }
    }

    // Start the scanner when the page loads
    window.addEventListener('load', startScanner);
  </script>
</body>
</html>
